<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Book Appointment | SmartCare</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">

  <style>
    .doctor-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 25px;
    }

    .doctor-card {
      background: #fff;
      padding: 18px;
      border-radius: 14px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
      cursor: pointer;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
      border: 2px solid transparent;
    }

    .doctor-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 18px 35px rgba(0,0,0,0.15);
    }

    .doctor-card.selected {
      border-color: #2563eb;
      background: #eef2ff;
    }

    .selected-doctor {
      margin-top: 15px;
      font-weight: bold;
      color: #2563eb;
    }
  </style>
</head>

<body>

<nav>
  <h2>üè• SmartCare</h2>
  <div>
    <a href="index.html">Home</a>
    <a href="appointments.html"><b>Appointments</b></a>
    <a href="doctors.html">Doctors</a>
    <a href="prescription.html">Prescription</a>
  </div>
</nav>

<section class="section">
  <h2>üìÖ Book Appointment</h2>

  <input id="aptPatient" placeholder="Patient Name">
  <input id="aptDate" type="date">

  <h3 style="margin-top:25px;">üë®‚Äç‚öïÔ∏è Select Doctor</h3>

  <div class="doctor-grid" id="doctorList"></div>

  <p class="selected-doctor" id="selectedDoctorText"></p>

  <button type="button" onclick="addAppointment()" style="margin-top:20px;">
    Book Appointment
  </button>
</section>

<script>
const API = "https://smartcare-hospital.onrender.com";

const appointmentDoctors = [
  { name: "Dr. A. Rao", speciality: "General Physician" },
  { name: "Dr. Meena S.", speciality: "Pediatrician" },
  { name: "Dr. K. Kumar", speciality: "Orthopedic" },
  { name: "Dr. P. Sharma", speciality: "Cardiologist" }
];

let selectedDoctor = "";

const list = document.getElementById("doctorList");
const text = document.getElementById("selectedDoctorText");

appointmentDoctors.forEach(d => {
  const card = document.createElement("div");
  card.className = "doctor-card";
  card.innerHTML = `<h4>${d.name}</h4><span>${d.speciality}</span>`;

  card.onclick = () => {
    document.querySelectorAll(".doctor-card")
      .forEach(c => c.classList.remove("selected"));

    card.classList.add("selected");
    selectedDoctor = d.name;
    text.textContent = "Selected Doctor: " + d.name;
  };

  list.appendChild(card);
});

function addAppointment() {
  const patientName = document.getElementById("aptPatient").value.trim();
  const date = document.getElementById("aptDate").value;

  if (!patientName || !selectedDoctor || !date) {
    alert("Please fill all fields and select a doctor");
    return;
  }

  fetch(`${API}/appointments`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ patientName, doctor: selectedDoctor, date })
  })
  .then(res => res.json())
  .then(() => {
    alert("Appointment booked successfully");
    document.getElementById("aptPatient").value = "";
    document.getElementById("aptDate").value = "";
    selectedDoctor = "";
    text.textContent = "";
    document.querySelectorAll(".doctor-card")
      .forEach(c => c.classList.remove("selected"));
  })
  .catch(() => alert("Server error"));
}
</script>

</body>
</html>
