<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard | SmartCare</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

<script>
if (localStorage.getItem("adminLoggedIn") !== "yes") {
  location.href = "admin-login.html";
}
</script>

<nav>
  <h2>üè• SmartCare ‚Äì Admin</h2>
  <button onclick="logout()">Logout</button>
</nav>

<div class="container">
  <h3>üìã All Hospital Appointments</h3>
  <div id="records"></div>
</div>

<script>
const API = "https://smartcare-hospital.onrender.com";

function loadData() {
  fetch(`${API}/appointments`)
    .then(res => res.json())
    .then(data => {
      records.innerHTML = "";

      if (!data.length) {
        records.innerHTML = "<p>No records found</p>";
        return;
      }

      data.forEach(a => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <b>Patient:</b> ${a.patientName}<br>
          <b>Doctor:</b> ${a.doctor}<br>
          <b>Date:</b> ${a.date}<br><br>
          <button class="danger" onclick="del('${a._id}')">Delete</button>
        `;
        records.appendChild(card);
      });
    });
}

function del(id) {
  if (!confirm("Delete this record?")) return;

  fetch(`${API}/appointments/${id}`, {
    method: "DELETE"
  }).then(loadData);
}

function logout() {
  localStorage.removeItem("adminLoggedIn");
  location.href = "admin-login.html";
}

loadData();
</script>

</body>
</html>
